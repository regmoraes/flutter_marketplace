import 'package:flutter/material.dart';import 'package:marketplace/model/offer.dart';import 'package:marketplace/presentation/app_bloc.dart';import 'package:marketplace/presentation/offer_detail/alert.dart';import 'package:marketplace/presentation/offer_detail/offer_detail_widgets.dart';class OfferDetailPage extends StatefulWidget {  final Offer offer;  final AppBloc offersBloc;  const OfferDetailPage({Key key, this.offer, this.offersBloc})      : super(key: key);  @override  State<StatefulWidget> createState() => _OfferDetailPageState();}class _OfferDetailPageState extends State<OfferDetailPage> {  @override  void initState() {    super.initState();    widget.offersBloc.purchaseStream.listen(      (onData) {        if (onData != null) {          if (onData.purchase.success) {            purchaseAlert(context, "Awesome!", "You purchased your product",                () => Navigator.of(context).pop());          } else {            purchaseAlert(context, "Oh no!", onData.purchase.errorMessage,                () => Navigator.of(context).pop());          }        }      },    );  }  @override  Widget build(BuildContext context) {    return Scaffold(      appBar: AppBar(        title: Text(widget.offer.product.name),      ),      body: Container(        child: Column(          crossAxisAlignment: CrossAxisAlignment.center,          children: <Widget>[            buildOfferDetail(context, widget.offer),            buildPurchaseButton(widget.offersBloc.purchaseStream, () {              widget.offersBloc.purchaseOffer(widget.offer.id);            }),          ],        ),      ),    );  }}